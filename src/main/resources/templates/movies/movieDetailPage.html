<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/head :: head"></head>
<header th:replace="fragments/header :: header"></header>
<body>
<main role="main" class="container">

    <div class="jumbotron pb-3 pt-4" th:object="${movieSummary}">
        <div class="row">
            <div class="col-md-4">
                <img th:src="${movieSummary.getCover().getSource()}" class="card-img" th:alt="${movieSummary.getCover().getName()}" th:title="'@Author: ' + ${movieSummary.getCover().getAuthor()}">
            </div>
            <div class="col">
                <div class="row">
                    <div class="col">
                        <h1 class="text-dark" th:text="${movieSummary.getTitle()}">Title</h1>
                    </div>
                    <div class="col">
                        <h1 class="text-right"><span class="text-warning">★</span><span class="text-dark" th:text="${movieSummary.getAvgUsersRating()}">Rating</span></h1>
                    </div>
                </div>
                <h5 class="text-muted">
                    <a href="#" class="badge badge-pill badge-dark" th:each="category : ${movieSummary.getCategories()}" th:text="'#' + ${category}">#category</a>
                </h5>
                <br>
                <span th:text="${movieSummary.getDescription()}">Description</span>
                <hr class="my-4">
                <ul>
                    <li>
                        <span th:text="'Duration: ' + ${movieSummary.getDuration() + ' min'}">Duration</span>
                    </li>
                    <li>
                        <span th:text="'Director: ' + ${movieSummary.getDirector()}">Director</span>
                    </li>
                    <li>
                        <span th:text="'Scenario: ' + ${movieSummary.getScenario()}">Scenario</span>
                    </li>
                    <li>
                        <span th:text="'Country: ' + ${movieSummary.getCountry()}">Country</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="jumbotron pb-3 pt-4" th:object="${movieRating}">
        <h4 th:text="'Average users rating: ' + ${movieRating.getAvg()} + '★'">Average users rating</h4>
        <ul>
            <li>
                <span th:text="'Cast: ' + ${movieRating.getCast()} + '★'">Cast</span>
            </li>
            <li>
                <span th:text="'Story: ' + ${movieRating.getStory()} + '★'">Story</span>
            </li>
            <li>
                <span th:text="'Music: ' + ${movieRating.getMusic()} + '★'">Music</span>
            </li>
        </ul>
        <hr class="my-4">
        <ul class="list-inline text-center">
            <li class="list-inline-item">
                <span th:text="'• ' + ${movieRating.getNumberOfPeopleWhoWatched()} + ' users have rated this movie'">Number of users have rated this movie</span>
            </li>
            <li class="list-inline-item">
                <span th:text="'• ' + ${movieRating.getNumberOfPeopleWhoWantToWatch()} + ' users want to see'">Number of users want to see</span>
            </li>
        </ul>
    </div>

    <div class="jumbotron pb-3 pt-4" th:object="${movieMedia}">
        <h4>Photos</h4>
            <div id="carouselPhotos" class="carousel slide bg-dark rounded" data-ride="carousel">
                <ol class="carousel-indicators">
                    <li th:each="id : ${movieMedia.getPhotos()}" data-target="#carouselPhotos" th:data-slide-to="${idStat.index}" th:classappend="${idStat.first}? active"></li>
                </ol>
                <div class="carousel-inner">
                    <div th:each="photo : ${movieMedia.getPhotos()}" class="carousel-item" th:classappend="${photoStat.first}? active">
                        <img th:src="${photo.getSource()}" class="d-block mx-auto" style="max-height: 500px;" th:alt="${photo.getName()}">
                        <div class="carousel-caption d-none d-md-block">
                            <span class="bg-dark px-3 py-1 rounded-pill" th:text="'@Author: ' + ${photo.getAuthor()}">@Author</span>
                        </div>
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carouselPhotos" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselPhotos" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
    </div>

    <div class="jumbotron pb-3 pt-4" th:object="${movieMedia}">
        <h4>Trailer</h4>
        <div class="embed-responsive embed-responsive-16by9">
            <iframe class="embed-responsive-item" th:src="${movieMedia.getTrailerLink()}" allowfullscreen></iframe>
        </div>
    </div>

    <div class="jumbotron pb-3 pt-4" th:object="${movieCast}">
        <h4>Cast</h4>
        <div class="row">
            <div class="col">
                <p class="text-right font-weight-bold" th:each="actor : ${movieCast.getCast()}" th:text="${actor.getActorName()}">Actor name</p>
            </div>
            <div class="col">
                <p class="text-left" th:each="character : ${movieCast.getCast()}" th:text="${character.getCharacterName()}">Don Vito Corleone</p>
            </div>
        </div>
    </div>

    <form th:action="@{/movie/1}" method="get" class="jumbotron pb-3 pt-4" id="comments">
        <h4>Comments</h4>
        <div class="row pb-4">
            <div class="col">
                <div class="input-group">
                    <div class="input-group-prepend">
                        <button class="btn btn-outline-dark bg-dark text-white px-4" type="submit">Sort by</button>
                    </div>
                    <select class="custom-select border-dark" th:name="sort">
                        <option value="1" th:selected="${#httpServletRequest.getParameter('sort') == '1'}">Date descending</option>
                        <option value="2" th:selected="${#httpServletRequest.getParameter('sort') == '2'}">Date ascending</option>
                        <option value="3" th:selected="${#httpServletRequest.getParameter('sort') == '3'}">Rate descending</option>
                        <option value="4" th:selected="${#httpServletRequest.getParameter('sort') == '4'}">Rate ascending</option>
                    </select>
                </div>
            </div>
            <div class="col text-center">
                <h4>
                    <span class="badge bg-dark text-white py-2">Number of comments <span class="badge badge-light" th:text="${commentPage.getTotalElements()}">number of comments</span></span>
                </h4>
            </div>
            <div class="col">
                <div class="input-group">
                    <select class="custom-select border-dark" th:name="size" th:field="*{commentPage.size}">
                        <option value="10">10 comments per page</option>
                        <option value="20">20 comments per page</option>
                        <option value="50">50 comments per page</option>
                    </select>
                    <div class="input-group-append">
                        <button class="btn btn-outline-dark bg-dark text-white px-4" type="submit">Show</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="card border-dark mb-2" th:each="comment : ${commentPage.getContent()}">
            <div class="card-header">
                <div class="row">
                    <div class="col text-left font-weight-bold text-dark" th:text="${comment.getAuthor()}">author</div>
                    <div class="col text-right font-weight-light text-dark" th:text="${#dates.format(comment.getDate(), 'dd.MM.yyyy HH:mm')}">dd.MM.yyyy HH:mm</div>
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col">
                        <span th:text="${comment.getContent()}">content</span>
                    </div>
                    <div class="col-md-auto">
                        <div class="input-group">
                            <input type="button" class="form-control bg-dark border-dark text-danger font-weight-bold" value="-"/>
                            <div class="input-group-append">
                                <span class="input-group-text text-dark border-dark bg-white font-weight-bold" th:text="${comment.getRating()}">rate</span>
                            </div>
                            <input type="button" class="form-control bg-dark border-dark text-success font-weight-bold" value="+"/>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <nav class="pt-3">
            <ul class="pagination justify-content-center">
                <li class="page-item" th:classappend="${commentPage.first}? disabled">
                    <a class="page-link border-dark text-dark" th:href="@{/movie/{id} (id=1, size=${commentPage.size}, page=1)} ">|<</a>
                </li>
                <li class="page-item" th:classappend="${!commentPage.hasPrevious()}? disabled">
                    <a class="page-link border-dark text-dark" th:href="@{/movie/{id} (id=1, size=${commentPage.size}, page=${commentPage.getNumber()})}"><</a>
                </li>
                <li class="page-item disabled">
                    <a class="page-link border-dark bg-dark text-white" th:text="${commentPage.getNumber()+1} + ' of ' + ${commentPage.getTotalPages()}">current page</a>
                </li>
                <li class="page-item" th:classappend="${!commentPage.hasNext()}? disabled">
                    <a class="page-link border-dark text-dark" th:href="@{/movie/{id} (id=1, size=${commentPage.size}, page=${commentPage.getNumber()+2})}">></a>
                </li>
                <li class="page-item" th:classappend="${commentPage.last}? disabled">
                    <a class="page-link border-dark text-dark" th:href="@{/movie/{id} (id=1, size=${commentPage.size}, page=${commentPage.getTotalPages()}, sort=${commentPage.sort})}">>|</a>
                </li>
            </ul>
        </nav>

    </form>

</main>
</body>
<footer th:replace="fragments/footer :: footer"></footer>
</html>